{
  int count=0;
  for (  CombatGroup group : groups) {
    count+=group.getAttackers().size();
  }
  if (count > 1) {
    List<UUID> tobeRemoved=new ArrayList<>();
    for (    CombatGroup group : groups) {
      for (      UUID attackingCreatureId : group.getAttackers()) {
        Permanent attacker=game.getPermanent(attackingCreatureId);
        if (count > 1 && attacker != null && attacker.getAbilities().containsKey(CanAttackOnlyAloneAbility.getInstance().getId())) {
          if (!game.isSimulation()) {
            game.informPlayers(attacker.getLogName() + " can only attack alone. Removing it from combat.");
          }
          tobeRemoved.add(attackingCreatureId);
          count--;
        }
      }
    }
    for (    UUID attackingCreatureId : tobeRemoved) {
      this.removeAttacker(attackingCreatureId,game);
    }
  }
  if (count == 1) {
    List<UUID> tobeRemoved=new ArrayList<>();
    for (    CombatGroup group : groups) {
      for (      UUID attackingCreatureId : group.getAttackers()) {
        Permanent attacker=game.getPermanent(attackingCreatureId);
        if (attacker != null && attacker.getAbilities().containsKey(CantAttackAloneAbility.getInstance().getId())) {
          if (!game.isSimulation()) {
            game.informPlayers(attacker.getLogName() + " can't attack alone. Removing it from combat.");
          }
          tobeRemoved.add(attackingCreatureId);
        }
      }
    }
    for (    UUID attackingCreatureId : tobeRemoved) {
      this.removeAttacker(attackingCreatureId,game);
    }
  }
}
