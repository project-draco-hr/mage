{
  try {
    while (!end && session.isConnected()) {
      try {
        final ClientCallback callback=session.callback(id);
        session.ack(id,callback.getMessageId());
        if (callbackExecutor.isShutdown())         logger.fatal("Attempt to submit callback to shutdown executor");
 else         client.processCallback(callback);
      }
 catch (      ServerUnavailable ex) {
        session.handleServerUnavailable(ex);
      }
catch (      Exception ex) {
        logger.fatal("CallbackClientDaemon failed ",ex);
      }
    }
  }
 catch (  Exception ex) {
    logger.fatal("CallbackClientDaemon error ",ex);
  }
  logger.info("CallbackClientDaemon stopped");
}
