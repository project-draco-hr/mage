{
  try {
    while (!end) {
      try {
        Callback callbackMethod=new Callback(connection,id);
        final ClientCallback callback=callbackMethod.makeDirectCall();
        Ack ackMethod=new Ack(connection,id,callback.getMessageId());
        ackMethod.makeCall();
        callbackExecutor.submit(new Runnable(){
          @Override public void run(){
            try {
              client.processCallback(callback);
            }
 catch (            Exception ex) {
              logger.fatal("CallbackClientDaemon error ",ex);
            }
          }
        }
);
      }
 catch (      CallbackException ex) {
        logger.fatal("Callback failed ",ex);
      }
    }
  }
 catch (  Exception ex) {
    logger.fatal("CallbackClientDaemon error ",ex);
  }
}
