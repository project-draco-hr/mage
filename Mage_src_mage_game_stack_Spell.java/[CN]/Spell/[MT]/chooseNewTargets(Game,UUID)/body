{
  Player player=game.getPlayer(playerId);
  if (player != null) {
    for (    SpellAbility spellAbility : spellAbilities) {
      for (      Target target : spellAbility.getTargets()) {
        Target newTarget=target.copy();
        newTarget.clearChosen();
        for (        UUID targetId : target.getTargets()) {
          MageObject object=game.getObject(targetId);
          String name=null;
          if (object == null) {
            Player targetPlayer=game.getPlayer(targetId);
            if (targetPlayer != null)             name=targetPlayer.getName();
          }
 else {
            name=object.getName();
          }
          if (name != null && player.chooseUse(spellAbility.getEffects().get(0).getOutcome(),"Change target from " + name + "?",game)) {
            if (!player.chooseTarget(spellAbility.getEffects().get(0).getOutcome(),newTarget,spellAbility,game))             newTarget.addTarget(targetId,spellAbility,game,false);
          }
 else {
            newTarget.addTarget(targetId,spellAbility,game,false);
          }
        }
        target.clearChosen();
        for (        UUID newTargetId : newTarget.getTargets()) {
          target.addTarget(newTargetId,spellAbility,game,false);
        }
      }
    }
    return true;
  }
  return false;
}
