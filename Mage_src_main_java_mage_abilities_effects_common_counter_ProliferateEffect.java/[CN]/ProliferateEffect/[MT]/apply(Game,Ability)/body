{
  Player controller=game.getPlayer(source.getControllerId());
  if (controller == null) {
    return false;
  }
  Target target=new TargetPermanentOrPlayerWithCounter(0,Integer.MAX_VALUE,true);
  Map<String,Serializable> options=new HashMap<>();
  options.put("UI.right.btn.text","Done");
  controller.choose(Outcome.Benefit,target,source.getSourceId(),game,options);
  for (int idx=0; idx < target.getTargets().size(); idx++) {
    UUID chosen=(UUID)target.getTargets().get(idx);
    Permanent permanent=game.getPermanent(chosen);
    if (permanent != null) {
      if (permanent.getCounters(game).size() > 0) {
        if (permanent.getCounters(game).size() == 1) {
          for (          Counter counter : permanent.getCounters(game).values()) {
            Counter newCounter=new Counter(counter.getName());
            permanent.addCounters(newCounter,game);
          }
        }
 else {
          Choice choice=new ChoiceImpl(true);
          Set<String> choices=new HashSet<>();
          for (          Counter counter : permanent.getCounters(game).values()) {
            choices.add(counter.getName());
          }
          choice.setChoices(choices);
          choice.setMessage("Choose a counter to proliferate (" + permanent.getIdName() + ")");
          controller.choose(Outcome.Benefit,choice,game);
          for (          Counter counter : permanent.getCounters(game).values()) {
            if (counter.getName().equals(choice.getChoice())) {
              Counter newCounter=new Counter(counter.getName());
              permanent.addCounters(newCounter,game);
              break;
            }
          }
        }
      }
    }
 else {
      Player player=game.getPlayer(chosen);
      if (player != null) {
        if (player.getCounters().size() > 0) {
          if (player.getCounters().size() == 1) {
            for (            Counter counter : player.getCounters().values()) {
              Counter newCounter=new Counter(counter.getName());
              player.addCounters(newCounter,game);
            }
          }
 else {
            Choice choice=new ChoiceImpl(true);
            Set<String> choices=new HashSet<>();
            for (            Counter counter : player.getCounters().values()) {
              choices.add(counter.getName());
            }
            choice.setChoices(choices);
            choice.setMessage("Choose a counter to proliferate (" + player.getLogName() + ")");
            controller.choose(Outcome.Benefit,choice,game);
            for (            Counter counter : player.getCounters().values()) {
              if (counter.getName().equals(choice.getChoice())) {
                Counter newCounter=new Counter(counter.getName());
                player.addCounters(newCounter,game);
                break;
              }
            }
          }
        }
      }
    }
  }
  return true;
}
