{
  if (game.getStep().getType() == PhaseStep.UNTAP) {
    if (game.getTurnNum() != turn) {
      turn=game.getTurnNum();
      applies=false;
      Permanent storageMatrix=game.getPermanent(source.getSourceId());
      if (storageMatrix != null && !storageMatrix.isTapped()) {
        Choice choiceImpl=new ChoiceImpl(true);
        choiceImpl.setMessage("Untap which kind of permanent?");
        choiceImpl.setChoices(choice);
        Player player=game.getPlayer(game.getActivePlayerId());
        if (player != null) {
          while (!player.choose(outcome,choiceImpl,game)) {
            if (!player.canRespond()) {
              return false;
            }
          }
          String choosenType=choiceImpl.getChoice();
          if (choosenType != null) {
            game.informPlayers(storageMatrix.getLogName() + ": " + player.getLogName()+ " chose to untap "+ choosenType);
            if (choosenType.equals(CardType.ARTIFACT.toString())) {
              type=CardType.ARTIFACT;
            }
 else             if (choosenType.equals(CardType.LAND.toString())) {
              type=CardType.LAND;
            }
 else {
              type=CardType.CREATURE;
            }
            applies=true;
          }
        }
      }
    }
    if (applies) {
      return !permanent.getCardType().contains(type);
    }
  }
  return false;
}
