{
  for (Iterator<TriggeredAbility> it=this.values().iterator(); it.hasNext(); ) {
    TriggeredAbility ability=it.next();
    if (ability.isInUseableZone(game,null,event.getType().equals(EventType.ZONE_CHANGE) || event.getType().equals(EventType.DESTROYED_PERMANENT))) {
      if (!game.getContinuousEffects().preventedByRuleModification(event,ability,game,false)) {
        MageObject object=null;
        if (!ability.getZone().equals(Zone.COMMAND) && !game.getState().getZone(ability.getSourceId()).equals(ability.getZone())) {
          object=game.getShortLivingLKI(ability.getSourceId(),ability.getZone());
        }
        if (object == null) {
          object=getMageObject(event,game,ability);
        }
        if (object != null) {
          if (checkAbilityStillExists(ability,event,object)) {
            if (object instanceof Permanent) {
              ability.setControllerId(((Permanent)object).getControllerId());
            }
            ability.setSourceObject(object);
            if (ability.checkTrigger(event,game)) {
              UUID controllerId=ability.getControllerId();
              ability.trigger(game,controllerId);
            }
          }
        }
      }
    }
  }
}
