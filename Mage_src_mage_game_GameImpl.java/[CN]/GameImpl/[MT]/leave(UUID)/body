{
  Player player=getPlayer(playerId);
  player.leave();
  if (this.isGameOver()) {
    return;
  }
  for (Iterator<Permanent> it=getBattlefield().getAllPermanents().iterator(); it.hasNext(); ) {
    Permanent perm=it.next();
    if (perm.getOwnerId().equals(playerId)) {
      if (perm.getAttachedTo() != null) {
        Permanent attachedTo=getPermanent(perm.getAttachedTo());
        if (attachedTo != null) {
          attachedTo.removeAttachment(perm.getId(),this);
        }
      }
      it.remove();
    }
  }
  this.getState().getContinuousEffects().removeInactiveEffects(this);
  for (Iterator<StackObject> it=getStack().iterator(); it.hasNext(); ) {
    StackObject object=it.next();
    if (object.getControllerId().equals(playerId)) {
      it.remove();
    }
  }
  for (Iterator<Permanent> it=getBattlefield().getAllPermanents().iterator(); it.hasNext(); ) {
    Permanent perm=it.next();
    if (perm.getControllerId().equals(playerId)) {
      perm.moveToExile(null,"",null,this);
    }
  }
  for (  ExileZone exile : this.getExile().getExileZones()) {
    for (Iterator<UUID> it=exile.iterator(); it.hasNext(); ) {
      Card card=this.getCard(it.next());
      if (card != null && card.getOwnerId().equals(playerId)) {
        it.remove();
      }
    }
  }
  Iterator it=gameCards.entrySet().iterator();
  while (it.hasNext()) {
    Entry<UUID,Card> entry=(Entry<UUID,Card>)it.next();
    Card card=entry.getValue();
    if (card.getOwnerId().equals(playerId)) {
      it.remove();
    }
  }
}
