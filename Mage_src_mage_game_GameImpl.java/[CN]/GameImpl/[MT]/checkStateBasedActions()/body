{
  boolean somethingHappened=false;
  for (  Player player : state.getPlayers().values()) {
    if (!player.hasLost() && (player.getLife() <= 0 || player.isEmptyDraw() || player.getCounters().getCount("Poison") >= 10)) {
      player.lost(this);
      somethingHappened=true;
    }
  }
  for (  Permanent perm : getBattlefield().getAllActivePermanents(CardType.CREATURE)) {
    if (perm.getToughness().getValue() == 0) {
      perm.moveToZone(Zone.GRAVEYARD,this,false);
      somethingHappened=true;
    }
 else     if (perm.getToughness().getValue() <= perm.getDamage() || perm.isDeathtouched()) {
      perm.destroy(null,this,false);
      somethingHappened=true;
    }
  }
  for (  Permanent perm : getBattlefield().getAllActivePermanents(CardType.PLANESWALKER)) {
    if (perm.getLoyalty().getValue() == 0) {
      perm.moveToZone(Zone.GRAVEYARD,this,false);
      return true;
    }
  }
  FilterPlaneswalkerPermanent filterPlaneswalker=new FilterPlaneswalkerPermanent();
  if (getBattlefield().countAll(filterPlaneswalker) > 1) {
    for (    Permanent planeswalker : getBattlefield().getAllActivePermanents(CardType.PLANESWALKER)) {
      for (      String planeswalkertype : planeswalker.getSubtype()) {
        filterPlaneswalker.getSubtype().clear();
        filterPlaneswalker.getSubtype().add(planeswalkertype);
        filterPlaneswalker.setScopeSubtype(ComparisonScope.Any);
        if (getBattlefield().count(filterPlaneswalker,planeswalker.getControllerId(),this) > 1) {
          for (          Permanent perm : getBattlefield().getActivePermanents(filterPlaneswalker,planeswalker.getControllerId(),this)) {
            perm.moveToZone(Zone.GRAVEYARD,this,false);
          }
          return true;
        }
      }
    }
  }
  FilterLegendaryPermanent filterLegendary=new FilterLegendaryPermanent();
  if (getBattlefield().countAll(filterLegendary) > 1) {
    for (    Permanent legend : getBattlefield().getAllActivePermanents(filterLegendary)) {
      FilterLegendaryPermanent filterLegendName=new FilterLegendaryPermanent();
      filterLegendName.getName().add(legend.getName());
      if (getBattlefield().count(filterLegendName,legend.getControllerId(),this) > 1) {
        for (        Permanent dupLegend : getBattlefield().getActivePermanents(filterLegendName,legend.getControllerId(),this)) {
          dupLegend.moveToZone(Zone.GRAVEYARD,this,false);
        }
        return true;
      }
    }
  }
  for (  Permanent perm : getBattlefield().getAllActivePermanents(new FilterEquipment())) {
    if (perm.getAttachedTo() != null) {
      Permanent creature=getPermanent(perm.getAttachedTo());
      if (creature == null) {
        perm.attachTo(null);
      }
 else       if (!creature.getCardType().contains(CardType.CREATURE)) {
        creature.removeAttachment(perm.getId(),this);
        somethingHappened=true;
      }
    }
  }
  for (  Permanent perm : getBattlefield().getAllActivePermanents(new FilterFortification())) {
    if (perm.getAttachedTo() != null) {
      Permanent land=getPermanent(perm.getAttachedTo());
      if (land == null) {
        perm.attachTo(null);
      }
 else       if (!land.getCardType().contains(CardType.LAND)) {
        land.removeAttachment(perm.getId(),this);
        somethingHappened=true;
      }
    }
  }
  for (  Permanent perm : getBattlefield().getAllActivePermanents()) {
    if (perm.getAttachments().size() > 0) {
      for (      UUID attachmentId : perm.getAttachments()) {
        Permanent attachment=getPermanent(attachmentId);
        if (!(attachment.getSubtype().contains("Aura") || attachment.getSubtype().contains("Equipment") || attachment.getSubtype().contains("Fortification"))) {
          perm.removeAttachment(id,this);
          return true;
        }
      }
    }
  }
  return somethingHappened;
}
