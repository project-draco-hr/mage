{
  Permanent permanent=copyFromPermanent.copy();
  permanent.reset(this);
  permanent.assignNewId();
  if (copyFromPermanent.isTransformed()) {
    TransformAbility.transform(permanent,copyFromPermanent.getSecondCardFace(),this);
  }
  applier.apply(this,permanent);
  Ability newAbility=source.copy();
  CopyEffect newEffect=new CopyEffect(permanent,copyToPermanent.getId());
  newEffect.newId();
  newEffect.setTimestamp();
  newEffect.init(newAbility,this);
  for (  Effect effect : getState().getContinuousEffects().getLayeredEffects(this)) {
    if (effect instanceof CopyEffect) {
      CopyEffect copyEffect=(CopyEffect)effect;
      if (!copyEffect.isInactive(null,this) && copyEffect.getSourceId().equals(copyFromPermanent.getId())) {
        MageObject object=((CopyEffect)effect).getTarget();
        if (object instanceof Permanent) {
          Permanent original=(Permanent)object;
          original=original.copy();
          applier.apply(this,original);
          newEffect.setTarget(object);
        }
      }
    }
  }
  state.addEffect(newEffect,copyToPermanent.getId(),newAbility);
}
