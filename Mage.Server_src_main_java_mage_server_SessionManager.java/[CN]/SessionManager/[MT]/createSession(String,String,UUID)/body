{
  for (  Session session : sessions.values()) {
    if (session.getUsername().equals(userName)) {
      if (session.getClientId().equals(clientId)) {
        logger.info("Reconnecting session " + session.getId() + " for "+ userName);
        return session.getId();
      }
 else {
        throw new MageException("User name already in use");
      }
    }
  }
  Session session=new Session(userName,host,clientId);
  sessions.put(session.getId(),session);
  logger.info("Session " + session.getId() + " created for user "+ userName);
  return session.getId();
}
