{
  for (  Session session : sessions.values()) {
    if (session.getUsername().equals(userName)) {
      if (session.getClientId().equals(clientId)) {
        logger.info("reconnecting session for " + userName);
        return session.getId();
      }
 else {
        throw new MageException("User name already in use");
      }
    }
  }
  Session session=new Session(userName,clientId);
  sessions.put(session.getId(),session);
  return session.getId();
}
