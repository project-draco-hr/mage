{
  if (sessionState == SessionState.CONNECTED)   sessionState=SessionState.DISCONNECTING;
  if (future != null && !future.isDone())   future.cancel(true);
  if (connection == null || server == null)   return;
  if (sessionState == SessionState.DISCONNECTING) {
    try {
      server.deregisterClient(sessionId);
    }
 catch (    Exception ex) {
      logger.fatal("Error disconnecting ...",ex);
    }
  }
  client.disconnected();
  logger.info("Disconnected ... ");
  if (sessionState == SessionState.SERVER_UNAVAILABLE && showMessage) {
    client.showError("Server error.  You have been disconnected");
  }
 else {
    sessionState=SessionState.DISCONNECTED;
  }
}
