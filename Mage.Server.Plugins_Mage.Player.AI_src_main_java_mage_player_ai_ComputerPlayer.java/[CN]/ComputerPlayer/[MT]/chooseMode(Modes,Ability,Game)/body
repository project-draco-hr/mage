{
  log.debug("chooseMode");
  if (modes.getMode() != null && modes.getMaxModes() == modes.getSelectedModes().size()) {
    return modes.getMode();
  }
  for (  Mode mode : modes.values()) {
    if (!modes.getSelectedModes().contains(mode.getId()) && mode.getTargets().canChoose(source.getSourceId(),source.getControllerId(),game)) {
      return mode;
    }
  }
  return null;
}
