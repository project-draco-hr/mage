{
  List<Permanent> threats=playerId == null ? game.getBattlefield().getAllActivePermanents(filter,game) : game.getBattlefield().getActivePermanents(filter,this.playerId,sourceId,game);
  Iterator<Permanent> it=threats.iterator();
  while (it.hasNext()) {
    Permanent test=it.next();
    if (targets.contains(test.getId()) || (playerId != null && !test.getControllerId().equals(playerId)))     it.remove();
  }
  Collections.sort(threats,new PermanentComparator(game));
  Collections.reverse(threats);
  return threats;
}
