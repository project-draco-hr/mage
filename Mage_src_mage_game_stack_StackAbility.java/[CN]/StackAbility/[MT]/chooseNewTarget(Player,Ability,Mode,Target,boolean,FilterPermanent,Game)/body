{
  Target newTarget=target.copy();
  newTarget.clearChosen();
  for (  UUID targetId : target.getTargets()) {
    String targetNames=getNamesOfTargets(targetId,game);
    if (targetNames != null && (forceChange || player.chooseUse(mode.getEffects().get(0).getOutcome(),"Change this target: " + targetNames + "?",game))) {
      if (forceChange && target.possibleTargets(this.getSourceId(),getControllerId(),game).size() > 1) {
        int iteration=0;
        do {
          if (iteration > 0 && !game.isSimulation()) {
            game.informPlayer(player,"You may only select exactly one target that must be different from the origin target!");
          }
          iteration++;
          newTarget.clearChosen();
          newTarget.chooseTarget(mode.getEffects().get(0).getOutcome(),player.getId(),ability,game);
          if (newTarget.getFirstTarget() != null && filterNewTarget != null) {
            Permanent newTargetPermanent=game.getPermanent(newTarget.getFirstTarget());
            if (newTargetPermanent == null || !filterNewTarget.match(newTargetPermanent,game)) {
              game.informPlayer(player,"Target does not fullfil the target requirements (" + filterNewTarget.getMessage() + ")");
              newTarget.clearChosen();
            }
          }
        }
 while (player.isInGame() && (targetId.equals(newTarget.getFirstTarget()) || newTarget.getTargets().size() != 1));
      }
 else {
        Target tempTarget=target.copy();
        if (target instanceof TargetAmount) {
          ((TargetAmount)tempTarget).setAmountDefinition(new StaticValue(target.getTargetAmount(targetId)));
        }
        tempTarget.setMinNumberOfTargets(1);
        tempTarget.setMaxNumberOfTargets(1);
        boolean again;
        do {
          again=false;
          tempTarget.clearChosen();
          if (!tempTarget.chooseTarget(mode.getEffects().get(0).getOutcome(),player.getId(),ability,game)) {
            if (player.chooseUse(Outcome.Benefit,"No target object selected. Reset to original target?",game)) {
              newTarget.addTarget(targetId,target.getTargetAmount(targetId),ability,game,false);
            }
 else {
              again=true;
            }
          }
 else {
            if (newTarget.getTargets().contains(tempTarget.getFirstTarget()) || target.getTargets().contains(tempTarget.getFirstTarget())) {
              if (player.isHuman()) {
                game.informPlayer(player,"This target was already selected from origin ability. You can only keep this target!");
                again=true;
              }
 else {
                newTarget.addTarget(targetId,target.getTargetAmount(targetId),ability,game,false);
              }
            }
 else             if (newTarget.getFirstTarget() != null && filterNewTarget != null) {
              Permanent newTargetPermanent=game.getPermanent(newTarget.getFirstTarget());
              if (newTargetPermanent == null || !filterNewTarget.match(newTargetPermanent,game)) {
                game.informPlayer(player,"This target does not fullfil the target requirements (" + filterNewTarget.getMessage() + ")");
                again=true;
              }
            }
 else {
              newTarget.addTarget(tempTarget.getFirstTarget(),target.getTargetAmount(targetId),ability,game,false);
            }
          }
        }
 while (again && player.isInGame());
      }
    }
 else {
      newTarget.addTarget(targetId,target.getTargetAmount(targetId),ability,game,false);
    }
  }
  return newTarget;
}
