{
  BufferedImage scaledImage=image;
  int w=image.getWidth();
  int h=image.getHeight();
  do {
    w/=2;
    h/=2;
    if (w < width || h < height) {
      w=width;
      h=height;
    }
    BufferedImage newImage=new BufferedImage(w,h,BufferedImage.TYPE_INT_ARGB);
    Graphics2D graphics2D=newImage.createGraphics();
    graphics2D.setRenderingHint(RenderingHints.KEY_INTERPOLATION,RenderingHints.VALUE_INTERPOLATION_BILINEAR);
    graphics2D.drawImage(scaledImage,0,0,w,h,null);
    graphics2D.dispose();
    scaledImage=newImage;
  }
 while (w != width || h != height);
  return scaledImage;
}
