{
  UUID defenderId=null;
  for (  PlayerAction action : actions) {
    if (action.getTurnNum() == game.getTurnNum() && action.getAction().startsWith("attack:")) {
      String command=action.getAction();
      command=command.substring(command.indexOf("attack:") + 7);
      String[] groups=command.split("\\$");
      for (int i=1; i < groups.length; i++) {
        String group=groups[i];
        if (group.startsWith("planeswalker=")) {
          String planeswalkerName=group.substring(group.indexOf("planeswalker=") + 13);
          for (          Permanent permanent : game.getBattlefield().getAllActivePermanents(new FilterPlaneswalkerPermanent(),game)) {
            if (permanent.getName().equals(planeswalkerName)) {
              defenderId=permanent.getId();
            }
          }
        }
        if (group.startsWith("defendingPlayer=")) {
          String defendingPlayerName=group.substring(group.indexOf("defendingPlayer=") + 16);
          for (          Player defendingPlayer : game.getPlayers().values()) {
            if (defendingPlayer.getName().equals(defendingPlayerName)) {
              defenderId=defendingPlayer.getId();
              break;
            }
          }
        }
      }
      if (defenderId == null) {
        for (        UUID uuid : game.getCombat().getDefenders()) {
          Player defender=game.getPlayer(uuid);
          if (defender != null) {
            defenderId=uuid;
          }
        }
      }
      FilterCreatureForCombat filter=new FilterCreatureForCombat();
      filter.add(new NamePredicate(groups[0]));
      filter.add(Predicates.not(new AttackingPredicate()));
      Permanent attacker=findPermanent(filter,playerId,game);
      if (attacker != null && attacker.canAttack(defenderId,game)) {
        this.declareAttacker(attacker.getId(),defenderId,game,false);
      }
    }
  }
}
