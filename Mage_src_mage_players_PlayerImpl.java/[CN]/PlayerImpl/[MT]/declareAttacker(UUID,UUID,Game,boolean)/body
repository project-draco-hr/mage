{
  if (allowUndo) {
    setStoredBookmark(game.bookmarkState());
  }
  Permanent attacker=game.getPermanent(attackerId);
  if (attacker != null && attacker.canAttack(game) && attacker.getControllerId().equals(playerId)) {
    if (!game.replaceEvent(GameEvent.getEvent(GameEvent.EventType.DECLARE_ATTACKER,defenderId,attackerId,playerId))) {
      game.getCombat().declareAttacker(attackerId,defenderId,game);
    }
  }
}
