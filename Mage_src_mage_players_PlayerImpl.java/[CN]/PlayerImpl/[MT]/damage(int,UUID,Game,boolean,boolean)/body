{
  if (damage > 0 && canDamage(game.getObject(sourceId))) {
    GameEvent event=new GameEvent(GameEvent.EventType.DAMAGE_PLAYER,playerId,sourceId,playerId,damage);
    if (!preventable || !game.replaceEvent(event)) {
      int actualDamage=event.getAmount();
      if (actualDamage > 0) {
        actualDamage=this.loseLife(actualDamage,game);
        Permanent source=game.getPermanent(sourceId);
        if (source != null && source.getAbilities().containsKey(LifelinkAbility.getInstance().getId())) {
          Player player=game.getPlayer(source.getControllerId());
          player.gainLife(actualDamage,game);
        }
        game.fireEvent(GameEvent.getEvent(GameEvent.EventType.DAMAGED_PLAYER,playerId,sourceId,playerId,actualDamage));
        if (combatDamage)         game.fireEvent(GameEvent.getEvent(GameEvent.EventType.COMBAT_DAMAGED_PLAYER,playerId,sourceId,playerId,actualDamage));
 else         game.fireEvent(GameEvent.getEvent(GameEvent.EventType.NONCOMBAT_DAMAGED_PLAYER,playerId,sourceId,playerId,actualDamage));
        return actualDamage;
      }
    }
  }
  return 0;
}
