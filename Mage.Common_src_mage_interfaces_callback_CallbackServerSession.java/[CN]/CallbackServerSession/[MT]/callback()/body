{
  callback.clear();
  lock.lock();
  try {
    waitingForCallback=true;
    waiting.signal();
    while (callback.getMethod() == null && threadAlive) {
      logger.trace("waiting for callback");
      callbackCalled.await();
    }
    waitingForCallback=false;
    logger.trace("callback called:" + callback.getMethod());
    return callback;
  }
  finally {
    lock.unlock();
  }
}
