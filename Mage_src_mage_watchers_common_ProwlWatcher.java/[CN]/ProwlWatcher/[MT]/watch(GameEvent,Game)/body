{
  if (event.getType() == EventType.DAMAGED_PLAYER) {
    DamagedPlayerEvent dEvent=(DamagedPlayerEvent)event;
    if (dEvent.isCombatDamage()) {
      Permanent creature=game.getPermanent(dEvent.getSourceId());
      if (creature != null) {
        Set<String> subtypes=damagingSubtypes.get(creature.getControllerId());
        if (subtypes == null) {
          subtypes=new LinkedHashSet<String>();
        }
        subtypes.addAll(creature.getSubtype());
        damagingSubtypes.put(creature.getControllerId(),subtypes);
      }
    }
  }
}
