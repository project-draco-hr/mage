{
  allActions.add(previousActions);
  ManaOptions available=getManaAvailable(game);
  available.addMana(manaPool.getMana());
  List<Ability> playables=game.getPlayer(playerId).getPlayable(game,filter,available,isSimulatedPlayer);
  playables=filterAbilities(game,playables,suggested);
  for (  Ability ability : playables) {
    List<Ability> options=game.getPlayer(playerId).getPlayableOptions(ability,game);
    if (options.size() == 0) {
      if (ability.getManaCosts().getVariableCosts().size() > 0) {
        simulateVariableCosts(ability,game);
      }
 else {
        allActions.add(ability);
      }
    }
 else {
      for (      Ability option : options) {
        if (ability.getManaCosts().getVariableCosts().size() > 0) {
          simulateVariableCosts(option,game);
        }
 else {
          allActions.add(option);
        }
      }
    }
  }
}
