{
  try {
    if (lock.tryLock(5,TimeUnit.SECONDS)) {
      User user=UserManager.getInstance().getUser(userId);
      if (user == null || !user.isConnected()) {
        return;
      }
      if (!user.getSessionId().equals(sessionId)) {
        logger.info("OLD SESSION IGNORED - " + user.getName());
        return;
      }
      logger.info("LOST CONNECTION - " + user.getName());
      UserManager.getInstance().disconnect(userId,DisconnectReason.LostConnection);
    }
 else {
      logger.error("SESSION LOCK - userId " + userId);
    }
  }
 catch (  InterruptedException ex) {
    logger.error("SESSION LOCK - userId " + userId,ex);
  }
 finally {
    lock.unlock();
  }
}
