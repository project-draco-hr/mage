{
  this.isAdmin=false;
  if (userName.equals("Admin"))   throw new MageException("User name already in use");
  User user=UserManager.getInstance().createUser(userName,host);
  if (user == null) {
    user=UserManager.getInstance().findUser(userName);
    if (user.getHost().equals(host)) {
      if (user.getSessionId().isEmpty())       logger.info("Reconnecting session for " + userName);
 else {
        logger.info("Disconnecting another user instance: " + userName);
        UserManager.getInstance().disconnect(user.getId());
      }
    }
 else {
      throw new MageException("User name already in use");
    }
  }
  if (!UserManager.getInstance().connectToSession(sessionId,user.getId()))   throw new MageException("Error connecting");
  this.userId=user.getId();
}
