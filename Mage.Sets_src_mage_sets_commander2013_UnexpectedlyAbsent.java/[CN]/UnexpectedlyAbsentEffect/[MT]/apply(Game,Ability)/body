{
  Permanent permanent=game.getPermanent(this.getTargetPointer().getFirst(game,source));
  if (permanent != null) {
    Player owner=game.getPlayer(permanent.getOwnerId());
    if (owner != null) {
      int xValue=Math.min(source.getManaCostsToPay().getX(),owner.getLibrary().size());
      Cards cards=new CardsImpl(Zone.PICK);
      List<UUID> cardIds=new ArrayList<>();
      for (int i=0; i < xValue; i++) {
        Card card=owner.getLibrary().getFromTop(game);
        cards.add(card);
        cardIds.add(card.getId());
      }
      permanent.moveToZone(Zone.LIBRARY,source.getSourceId(),game,true);
      ListIterator<UUID> l=cardIds.listIterator();
      while (l.hasPrevious()) {
        UUID cardId=l.previous();
        Card card=cards.get(cardId,game);
        if (card != null) {
          card.moveToZone(Zone.LIBRARY,source.getSourceId(),game,true);
        }
      }
      return true;
    }
  }
  return false;
}
