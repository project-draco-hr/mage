{
  ArrayList<CardInfo> cardsToDownload=new ArrayList<CardInfo>();
  ArrayList<CardInfo> allCardsUrls=new ArrayList<CardInfo>();
  try {
    offlineMode=true;
    for (    Card card : allCards) {
      if (card.getCardNumber() > 0 && !card.getExpansionSetCode().isEmpty()) {
        CardInfo url=new CardInfo(card.getName(),card.getExpansionSetCode(),card.getCardNumber(),false);
        allCardsUrls.add(url);
      }
 else {
        if (card.getCardNumber() < 1) {
          System.err.println("There was a critical error!");
          log.error("Card has no collector ID and won't be sent to client: " + card);
        }
 else         if (card.getExpansionSetCode().isEmpty()) {
          System.err.println("There was a critical error!");
          log.error("Card has no set name and won't be sent to client:" + card);
        }
      }
    }
    allCardsUrls.addAll(getTokenCardUrls());
  }
 catch (  Exception e) {
    log.error(e);
  }
  File file;
  for (  CardInfo card : allCardsUrls) {
    boolean withCollectorId=false;
    if (card.getName().equals("Forest") || card.getName().equals("Mountain") || card.getName().equals("Swamp")|| card.getName().equals("Island")|| card.getName().equals("Plains")) {
      withCollectorId=true;
    }
    file=new File(CardImageUtils.getImagePath(card,withCollectorId));
    if (!file.exists()) {
      cardsToDownload.add(card);
    }
  }
  for (  CardInfo card : cardsToDownload) {
    if (card.isToken()) {
      log.info("Card to download: " + card.getName() + " (Token) ");
    }
 else {
      try {
        log.info("Card to download: " + card.getName() + " ("+ card.getSet()+ ")");
      }
 catch (      Exception e) {
        log.error(e);
      }
    }
  }
  return cardsToDownload;
}
