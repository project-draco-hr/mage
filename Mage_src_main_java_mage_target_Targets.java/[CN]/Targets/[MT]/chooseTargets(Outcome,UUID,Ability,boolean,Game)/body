{
  if (this.size() > 0) {
    if (!canChoose(source.getSourceId(),playerId,game)) {
      return false;
    }
    int state=game.bookmarkState();
    while (!isChosen()) {
      Target target=this.getUnchosen().get(0);
      UUID targetController=playerId;
      if (target.getTargetController() != null) {
        targetController=target.getTargetController();
      }
      if (noMana) {
        target.setRequired(true);
      }
      if (!target.chooseTarget(outcome,targetController,source,game)) {
        return false;
      }
      if (this.getUnchosen().isEmpty() && game.replaceEvent(new GameEvent(GameEvent.EventType.TARGETS_VALID,source.getSourceId(),source.getSourceId(),source.getControllerId()),source)) {
        game.restoreState(state,"Targets");
        clearChosen();
      }
    }
  }
  return true;
}
