{
  for (  MagePermanent panel : permanents) {
    if (!type.isType(panel)) {
      continue;
    }
    if (!type.equals(RowType.attached) && RowType.attached.isType(panel)) {
      continue;
    }
    Stack stack=new Stack();
    stack.add(panel);
    if (panel.getOriginalPermanent().getAttachments() != null) {
      stack.setMaxAttachedCount(panel.getOriginalPermanent().getAttachments().size());
    }
    add(stack);
  }
}
