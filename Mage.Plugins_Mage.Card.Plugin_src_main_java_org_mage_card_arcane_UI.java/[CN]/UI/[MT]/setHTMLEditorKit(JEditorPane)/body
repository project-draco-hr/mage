{
  editorPane.getDocument().putProperty("imageCache",imageCache);
  editorPane.setEditorKit(new HTMLEditorKit(){
    private static final long serialVersionUID=-54602188235105448L;
    public ViewFactory getViewFactory(){
      return new HTMLFactory(){
        public View create(        Element elem){
          Object o=elem.getAttributes().getAttribute(StyleConstants.NameAttribute);
          if (o instanceof HTML.Tag) {
            HTML.Tag kind=(HTML.Tag)o;
            if (kind == HTML.Tag.IMG)             return new ImageView(elem){
              public URL getImageURL(){
                URL url=super.getImageURL();
                if (url != null && imageCache.get(url) == null)                 imageCache.put(url,Toolkit.getDefaultToolkit().createImage(url));
                return url;
              }
            }
;
          }
          return super.create(elem);
        }
      }
;
    }
  }
);
}
