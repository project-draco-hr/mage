{
  Player controller=game.getPlayer(source.getControllerId());
  Player targetPlayer=game.getPlayer(getTargetPointer().getFirst(game,source));
  if (controller != null && targetPlayer != null) {
    ArrayList<Card> cardsToManifest=new ArrayList<>();
    for (    Card card : targetPlayer.getGraveyard().getCards(new FilterCreatureCard(),game)) {
      cardsToManifest.add(card);
      controller.moveCardToExileWithInfo(card,null,"",source.getSourceId(),game,Zone.GRAVEYARD);
    }
    Collections.shuffle(cardsToManifest);
    game.informPlayers(controller.getName() + " shuffles the face-down pile");
    Ability newSource=source.copy();
    newSource.setWorksFaceDown(true);
    for (    Card card : cardsToManifest) {
      ManaCosts manaCosts=null;
      if (card.getCardType().contains(CardType.CREATURE)) {
        manaCosts=card.getSpellAbility().getManaCosts();
        if (manaCosts == null) {
          manaCosts=new ManaCostsImpl("{0}");
        }
      }
      MageObjectReference objectReference=new MageObjectReference(card.getId(),card.getZoneChangeCounter() + 1,game);
      game.addEffect(new BecomesFaceDownCreatureEffect(manaCosts,objectReference,Duration.Custom,FaceDownType.MANIFESTED),newSource);
      if (controller.putOntoBattlefieldWithInfo(card,game,Zone.EXILED,source.getSourceId(),false,true)) {
        game.informPlayers(new StringBuilder(controller.getName()).append(" puts facedown card from exile onto the battlefield").toString());
      }
    }
    return true;
  }
  return false;
}
