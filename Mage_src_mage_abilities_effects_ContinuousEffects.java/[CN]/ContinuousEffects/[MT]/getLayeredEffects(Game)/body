{
  List<ContinuousEffect> layerEffects=new ArrayList<ContinuousEffect>();
  for (  ContinuousEffect effect : layeredEffects) {
switch (effect.getDuration()) {
case WhileOnBattlefield:
case WhileOnStack:
case WhileInGraveyard:
      Ability ability=layeredEffects.getAbility(effect.getId());
    if (ability.isInUseableZone(game,null,false))     layerEffects.add(effect);
  break;
default :
layerEffects.add(effect);
}
}
updateTimestamps(layerEffects);
Collections.sort(layerEffects,new TimestampSorter());
return layerEffects;
}
