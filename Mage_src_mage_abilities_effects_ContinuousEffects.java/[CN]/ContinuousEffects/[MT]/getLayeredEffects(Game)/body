{
  List<ContinuousEffect> layerEffects=new ArrayList<ContinuousEffect>();
  for (  ContinuousEffect effect : layeredEffects) {
switch (effect.getDuration()) {
case WhileOnBattlefield:
case WhileOnStack:
case WhileInGraveyard:
      Ability ability=abilityMap.get(effect.getId());
    if (ability.isInUseableZone(game))     layerEffects.add(effect);
  break;
default :
layerEffects.add(effect);
}
}
Collections.sort(layerEffects,new TimestampSorter());
return layerEffects;
}
