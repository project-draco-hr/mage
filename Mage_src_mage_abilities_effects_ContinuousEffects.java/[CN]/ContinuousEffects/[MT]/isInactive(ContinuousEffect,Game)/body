{
switch (effect.getDuration()) {
case WhileOnBattlefield:
    Permanent permanent=game.getPermanent(abilityMap.get(effect.getId()).getSourceId());
  return (permanent == null || !permanent.isPhasedIn());
case OneUse:
return effect.isUsed();
case Custom:
return effect.isInactive(abilityMap.get(effect.getId()),game);
}
return false;
}
