{
  List<Card> cards=new ArrayList<Card>();
  List<Card> pool;
  if (set == null) {
    pool=getAllCards();
  }
 else {
    pool=new ArrayList<Card>();
    for (    Card card : getAllCards()) {
      if (card.getExpansionSetCode().equals(set)) {
        pool.add(card);
      }
    }
  }
  if (!onlyImplemented) {
    for (    Card card : getNotImplementedCards()) {
      if (card.getExpansionSetCode().equals(set)) {
        pool.add(card);
      }
    }
    Collections.sort(pool,new CardComparator());
  }
  for (int i=start; i < Math.min(end + 1,pool.size()); i++) {
    cards.add(pool.get(i));
  }
  return cards;
}
