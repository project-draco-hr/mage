{
  if (ability instanceof DiesAttachedTriggeredAbility) {
    Permanent attachedTo=null;
    for (    Effect effect : ability.getEffects()) {
      attachedTo=(Permanent)effect.getValue("attachedTo");
    }
    if (attachedTo != null) {
      Player creatureController=game.getPlayer(attachedTo.getControllerId());
      if (creatureController != null) {
        ability.setControllerId(creatureController.getId());
        ability.getTargets().clear();
        TargetCreaturePermanent target=new TargetCreaturePermanent(filter,true);
        target.setRequired(true);
        ability.getTargets().add(target);
      }
    }
  }
}
