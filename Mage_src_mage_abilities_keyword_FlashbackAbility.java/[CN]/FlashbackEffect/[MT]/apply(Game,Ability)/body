{
  Card card=(Card)game.getObject(source.getSourceId());
  if (card != null) {
    Player controller=game.getPlayer(source.getControllerId());
    if (controller != null) {
      SpellAbility spellAbility;
switch (((FlashbackAbility)source).getSpellAbilityType()) {
case SPLIT_LEFT:
        spellAbility=((SplitCard)card).getLeftHalfCard().getSpellAbility();
      break;
case SPLIT_RIGHT:
    spellAbility=((SplitCard)card).getRightHalfCard().getSpellAbility();
  break;
default :
spellAbility=card.getSpellAbility();
}
spellAbility.clear();
int amount=source.getManaCostsToPay().getX();
if (amount == 0) {
for (Cost cost : source.getCosts()) {
if (cost instanceof VariableCost && cost.isPaid()) {
  amount=((VariableCost)cost).getAmount();
  break;
}
}
}
if (amount > 0) {
for (VariableCost variableCost : spellAbility.getManaCostsToPay().getVariableCosts()) {
if (variableCost instanceof VariableManaCost) {
  amount=amount * ((VariableManaCost)variableCost).getMultiplier();
  break;
}
}
spellAbility.getManaCostsToPay().setX(amount);
}
for (Target target : spellAbility.getTargets()) {
target.setRequired(true);
}
game.informPlayers(new StringBuilder(controller.getName()).append(" flashbacks ").append(card.getName()).toString());
return controller.cast(spellAbility,game,true);
}
}
return false;
}
