{
  Player player=game.getPlayer(playerId);
  Player opponent=game.getPlayer(game.getOpponents(playerId).iterator().next());
  if (game.isGameOver()) {
    if (player.hasLost() || opponent.hasWon())     return Integer.MIN_VALUE;
    if (opponent.hasLost() || player.hasWon())     return Integer.MAX_VALUE;
  }
  int lifeScore=(player.getLife() - opponent.getLife()) * LIFE_FACTOR;
  int permanentScore=0;
  for (  Permanent permanent : game.getBattlefield().getAllActivePermanents(playerId)) {
    permanentScore+=evaluatePermanent(permanent,game);
  }
  for (  Permanent permanent : game.getBattlefield().getAllActivePermanents(opponent.getId())) {
    permanentScore-=evaluatePermanent(permanent,game);
  }
  permanentScore*=PERMANENT_FACTOR;
  int handScore=0;
  handScore=player.getHand().size() - opponent.getHand().size();
  handScore*=HAND_FACTOR;
  int score=lifeScore + permanentScore + handScore;
  if (logger.isDebugEnabled())   logger.debug("game state evaluated to- lifeScore:" + lifeScore + " permanentScore:"+ permanentScore+ " handScore:"+ handScore+ " total:"+ score);
  return score;
}
