{
  if (data.card.getRarity().equals(Constants.Rarity.NA)) {
    return;
  }
  if (data.component instanceof MageCard) {
    String zone=((MageCard)(data.component)).getZone();
    if (zone != null && zone.equals(Constants.Zone.HAND.toString())) {
      String showTooltips=PreferencesDialog.getCachedValue(PreferencesDialog.KEY_HAND_SHOW_TOOLTIPS,"false");
      if (showTooltips.equals("false")) {
        return;
      }
    }
  }
  if (cardInfoPane == null) {
    PopupFactory factory=PopupFactory.getSharedInstance();
    popup=factory.getPopup(data.component,data.popupText,(int)data.locationOnScreen.getX() + data.popupOffsetX,(int)data.locationOnScreen.getY() + data.popupOffsetY + 40);
    popup.show();
    popup.hide();
    popup=factory.getPopup(data.component,data.popupText,(int)data.locationOnScreen.getX() + data.popupOffsetX,(int)data.locationOnScreen.getY() + data.popupOffsetY + 40);
    popup.show();
  }
 else {
    ThreadUtils.threadPool2.submit(new Runnable(){
      @Override public void run(){
        ThreadUtils.sleep(700);
        if (popupCard == null || !popupCard.equals(data.card)) {
          return;
        }
        try {
          if (session == null || !state) {
            return;
          }
          final Component popupContainer=MageFrame.getUI().getComponent(MageComponents.POPUP_CONTAINER);
          Component popup2=MageFrame.getUI().getComponent(MageComponents.CARD_INFO_PANE);
          ((CardInfoPane)popup2).setCard(data.card);
          Point location=new Point((int)data.locationOnScreen.getX() + data.popupOffsetX - 40,(int)data.locationOnScreen.getY() + data.popupOffsetY - 40);
          location=GuiDisplayUtil.keepComponentInsideParent(location,parentPoint,popup2,parentComponent);
          location.translate(-parentPoint.x,-parentPoint.y);
          popupContainer.setLocation(location);
          ThreadUtils.sleep(200);
          final Component c=MageFrame.getUI().getComponent(MageComponents.DESKTOP_PANE);
          SwingUtilities.invokeLater(new Runnable(){
            @Override public void run(){
              if (!state) {
                return;
              }
              popupContainer.setVisible(true);
              c.repaint();
            }
          }
);
        }
 catch (        Exception e) {
          e.printStackTrace();
        }
      }
    }
);
  }
}
