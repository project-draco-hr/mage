{
  String filePath;
  TFile file;
  if (card.isToken()) {
    if (pathCache.containsKey(card)) {
      return pathCache.get(card);
    }
    filePath=getTokenImagePath(card);
    file=new TFile(filePath);
    if (!file.exists()) {
      filePath=searchForCardImage(card);
      file=new TFile(filePath);
    }
    if (file.exists()) {
      pathCache.put(card,filePath);
    }
  }
 else {
    String useDefault=PreferencesDialog.getCachedValue(PreferencesDialog.KEY_CARD_IMAGES_USE_DEFAULT,"true");
    String path=useDefault.equals("true") ? null : PreferencesDialog.getCachedValue(PreferencesDialog.KEY_CARD_IMAGES_PATH,null);
    filePath=getImagePath(card,path);
    file=new TFile(filePath);
  }
  if (file.exists()) {
    return filePath;
  }
 else {
    return null;
  }
}
