{
  Calendar cal=new GregorianCalendar();
  final String msg=timeFormatter.format(cal.getTime()) + " " + userName+ ":"+ message;
  logger.debug("Broadcasting '" + msg + "' for "+ chatId);
  for (  UUID sessionId : clients.keySet()) {
    Session session=SessionManager.getInstance().getSession(sessionId);
    if (session != null)     try {
      session.fireCallback(new ClientCallback("chatMessage",chatId,new ChatMessage(msg,color)));
    }
 catch (    CallbackException ex) {
      logger.fatal("broadcast error",ex);
    }
 else     kill(sessionId);
  }
}
