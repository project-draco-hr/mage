{
  Player controller=game.getPlayer(source.getControllerId());
  if (controller != null) {
    TargetControlledCreaturePermanent target=new TargetControlledCreaturePermanent();
    target.setNotTarget(true);
    if (target.canChoose(source.getControllerId(),game) && controller.chooseUse(outcome,"Cipher this spell to a creature?",source,game)) {
      controller.chooseTarget(outcome,target,source,game);
      Card sourceCard=game.getCard(source.getSourceId());
      Permanent targetCreature=game.getPermanent(target.getFirstTarget());
      if (targetCreature != null && sourceCard != null) {
        String ruleText=new StringBuilder("you may cast a copy of ").append(sourceCard.getLogName()).append(" without paying its mana cost").toString();
        Ability ability=new DealsCombatDamageToAPlayerTriggeredAbility(new CipherStoreEffect(source.getSourceId(),ruleText),true);
        ContinuousEffect effect=new GainAbilityTargetEffect(ability,Duration.Custom);
        effect.setTargetPointer(new FixedTarget(target.getFirstTarget()));
        game.addEffect(effect,source);
        if (!game.isSimulation()) {
          game.informPlayers(new StringBuilder(sourceCard.getLogName()).append(": Spell ciphered to ").append(targetCreature.getLogName()).toString());
        }
        return controller.moveCards(sourceCard,null,Zone.EXILED,source,game);
      }
 else {
        return false;
      }
    }
    return true;
  }
  return false;
}
