{
  String ipParam=System.getProperty("server");
  if (ipParam != null) {
    ip=ipParam;
  }
  if (ip.equals("localhost")) {
    try {
      String foundIP="";
      for (Enumeration<NetworkInterface> interfaces=NetworkInterface.getNetworkInterfaces(); interfaces.hasMoreElements(); ) {
        NetworkInterface iface=interfaces.nextElement();
        if (iface.isLoopback())         continue;
        for (        InterfaceAddress addr : iface.getInterfaceAddresses()) {
          InetAddress iaddr=addr.getAddress();
          if (iaddr instanceof Inet4Address) {
            foundIP=iaddr.getHostAddress();
            break;
          }
        }
        if (foundIP.length() > 0)         break;
      }
      if (foundIP.length() > 0)       ip=foundIP;
    }
 catch (    SocketException ex) {
      logger.warn("Could not get server address: ",ex);
    }
  }
  System.setProperty("java.rmi.server.hostname",ip);
  System.setProperty("sun.rmi.transport.tcp.readTimeout","30000");
  logger.info("MAGE server - using address " + ip);
}
