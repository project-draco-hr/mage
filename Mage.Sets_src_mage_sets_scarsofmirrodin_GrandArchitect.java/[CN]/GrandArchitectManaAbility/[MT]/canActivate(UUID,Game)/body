{
  boolean artifactSpellBeingCast=false;
  SpellStack stack=game.getStack();
  for (int idx=0; idx < stack.size(); idx++) {
    StackObject stackObject=stack.get(idx);
    if (stackObject.getControllerId().equals(playerId)) {
      artifactSpellBeingCast|=stackObject.getCardType().contains(CardType.ARTIFACT);
      MageObject source=game.getObject(stackObject.getSourceId());
      if (source != null)       artifactSpellBeingCast|=source.getCardType().contains(CardType.ARTIFACT);
    }
  }
  return super.canActivate(playerId,game) && artifactSpellBeingCast;
}
