{
  Ability ability=abilityMap.get(effect.getId());
  if (ability == null)   return true;
  if (effect.isDiscarded())   return true;
switch (effect.getDuration()) {
case WhileOnBattlefield:
    if (game.getObject(ability.getSourceId()) == null)     return (true);
case OneUse:
  return effect.isUsed();
case Custom:
return effect.isInactive(abilityMap.get(effect.getId()),game);
}
return false;
}
