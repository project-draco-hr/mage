{
  if (table.getState() != TableState.WAITING) {
    return false;
  }
  Seat seat=table.getNextAvailableSeat(playerType);
  if (seat == null) {
    throw new GameException("No available seats.");
  }
  Deck deck=Deck.load(deckList,false,false);
  if (!Main.isTestMode() && !table.getValidator().validate(deck)) {
    throw new InvalidDeckException(name + " has an invalid deck for this format",table.getValidator().getInvalid());
  }
  Player player=createPlayer(name,seat.getPlayerType(),skill);
  if (player == null) {
    throw new GameException(new StringBuilder("Could not create player ").append(name).append(" of type ").append(seat.getPlayerType().toString()).toString());
  }
  match.addPlayer(player,deck);
  table.joinTable(player,seat);
  User user=UserManager.getInstance().getUser(userId);
  user.addTable(player.getId(),table);
  logger.info("player joined " + player.getId());
  if (seat.getPlayer().isHuman()) {
    user.joinedTable(table.getRoomId(),table.getId(),false);
    userPlayerMap.put(userId,player.getId());
  }
  return true;
}
