{
  this.userId=userId;
  chatId=ChatManager.getInstance().createChatSession();
  tournament=TournamentFactory.getInstance().createTournament(options.getTournamentType(),options);
  if (userId != null) {
    User user=UserManager.getInstance().getUser(userId);
    if (user == null) {
      logger.fatal(new StringBuilder("User for userId ").append(userId).append(" could not be retrieved from UserManager").toString());
      controllerName="[unknown]";
    }
 else {
      controllerName=user.getName();
    }
  }
 else {
    controllerName="System";
  }
  table=new Table(roomId,options.getTournamentType(),options.getName(),controllerName,DeckValidatorFactory.getInstance().createDeckValidator(options.getMatchOptions().getDeckType()),options.getPlayerTypes(),tournament);
}
