{
  debugServerState();
  Date now=new Date();
  List<UUID> toRemove=new ArrayList<>();
  for (  Table table : tables.values()) {
    if (!table.getState().equals(TableState.FINISHED)) {
      long diff=(now.getTime() - table.getCreateTime().getTime()) / EXPIRE_TIME_UNIT_VALUE;
      if (diff >= EXPIRE_TIME) {
        logger.warn("Table expired: id = " + table.getId() + ", created_by="+ table.getControllerName()+ ". Removing...");
        toRemove.add(table.getId());
      }
 else       if (!table.isTournament()) {
        TableController tableController=getController(table.getId());
        if (!tableController.isMatchTableStillValid()) {
          logger.warn("Table with no active human player: id = " + table.getId() + ", created_by="+ table.getControllerName()+ ". Removing...");
          toRemove.add(table.getId());
        }
      }
    }
  }
  for (  UUID tableId : toRemove) {
    try {
      removeTable(tableId);
    }
 catch (    Exception e) {
      logger.error(e);
    }
  }
}
