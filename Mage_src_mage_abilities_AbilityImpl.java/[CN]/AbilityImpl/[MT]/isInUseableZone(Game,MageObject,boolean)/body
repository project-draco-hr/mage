{
  if (zone.equals(Zone.COMMAND)) {
    if (this.getSourceId() == null) {
      return true;
    }
    MageObject object=game.getObject(this.getSourceId());
    if (object != null && object instanceof Emblem) {
      return true;
    }
  }
  if (checkLKI) {
    MageObject lkiTest=game.getShortLivingLKI(getSourceId(),zone);
    if (lkiTest != null) {
      return true;
    }
  }
  MageObject object;
  UUID parameterSourceId;
  if (this instanceof MageSingleton && source != null) {
    object=source;
    parameterSourceId=source.getId();
  }
 else {
    object=game.getObject(getSourceId());
    parameterSourceId=getSourceId();
  }
  if (object != null && !object.getAbilities().contains(this)) {
    boolean found=false;
    if (object instanceof PermanentCard && ((PermanentCard)object).canTransform()) {
      PermanentCard permanent=(PermanentCard)object;
      found=permanent.getSecondCardFace().getAbilities().contains(this) || permanent.getCard().getAbilities().contains(this);
    }
    if (!found) {
      return false;
    }
  }
 else   if (object instanceof PermanentCard) {
    if (((PermanentCard)object).isFaceDown() && !this.getWorksFaceDown()) {
      return false;
    }
  }
  Zone test=game.getState().getZone(parameterSourceId);
  return test != null && zone.match(test);
}
