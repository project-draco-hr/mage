{
  if (!modes.choose(game,this)) {
    return false;
  }
  Card card=game.getCard(sourceId);
  if (card != null) {
    card.adjustChoices(this,game);
  }
  if (getChoices().size() > 0 && getChoices().choose(game,this) == false) {
    logger.debug("activate failed - choice");
    return false;
  }
  if (card != null) {
    for (    Ability ability : card.getAbilities()) {
      if (ability instanceof OptionalAdditionalSourceCosts) {
        ((OptionalAdditionalSourceCosts)ability).addOptionalAdditionalCosts(this,game);
      }
    }
  }
  VariableManaCost variableManaCost=null;
  for (  ManaCost cost : manaCostsToPay) {
    if (cost instanceof VariableManaCost) {
      variableManaCost=(VariableManaCost)cost;
      break;
    }
  }
  if (variableManaCost != null) {
    int xValue;
    if (!variableManaCost.isPaid()) {
      if (!noMana) {
        xValue=game.getPlayer(this.controllerId).announceXMana(variableManaCost.getMinX(),Integer.MAX_VALUE,"Announce the value for " + variableManaCost.getText(),game,this);
        int amountMana=xValue * variableManaCost.getMultiplier();
        manaCostsToPay.add(new ManaCostsImpl(new StringBuilder("{").append(amountMana).append("}").toString()));
        manaCostsToPay.setX(amountMana);
      }
      variableManaCost.setPaid();
    }
    xValue=getManaCostsToPay().getX();
    game.informPlayers(new StringBuilder(game.getPlayer(this.controllerId).getName()).append(" announced a value of ").append(xValue).append(" for ").append(variableManaCost.getText()).toString());
  }
  if (card != null) {
    card.adjustTargets(this,game);
  }
  if (getTargets().size() > 0 && getTargets().chooseTargets(getEffects().get(0).getOutcome(),this.controllerId,this,game) == false) {
    if (variableManaCost != null) {
      game.informPlayers(new StringBuilder(card.getName()).append(": no valid targets with this value of X").toString());
    }
 else {
      logger.debug("activate failed - target");
    }
    return false;
  }
  for (  Cost cost : optionalCosts) {
    if (cost instanceof ManaCost) {
      cost.clearPaid();
      if (game.getPlayer(this.controllerId).chooseUse(Outcome.Benefit,"Pay optional cost " + cost.getText() + "?",game)) {
        manaCostsToPay.add((ManaCost)cost);
      }
    }
  }
  if (card != null) {
    card.adjustCosts(this,game);
    for (    Ability ability : card.getAbilities()) {
      if (ability instanceof AdjustingSourceCosts) {
        ((AdjustingSourceCosts)ability).adjustCosts(this,game);
      }
    }
  }
  if (this instanceof ManaAbility && !costs.pay(this,game,sourceId,controllerId,noMana)) {
    logger.debug("activate mana ability failed - non mana costs");
    return false;
  }
  if (!useAlternativeCost(game)) {
    game.getContinuousEffects().costModification(this,game);
    if (!manaCostsToPay.pay(this,game,sourceId,controllerId,noMana)) {
      logger.debug("activate failed - mana");
      return false;
    }
  }
  UUID activatorId=controllerId;
  if ((this instanceof ActivatedAbilityImpl) && ((ActivatedAbilityImpl)this).getActivatorId() != null) {
    activatorId=((ActivatedAbilityImpl)this).getActivatorId();
  }
  if (!costs.pay(this,game,sourceId,activatorId,noMana)) {
    logger.debug("activate failed - non mana costs");
    return false;
  }
  return true;
}
