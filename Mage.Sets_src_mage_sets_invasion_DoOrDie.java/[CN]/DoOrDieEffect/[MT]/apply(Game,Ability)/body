{
  Player player=game.getPlayer(source.getControllerId());
  Player targetPlayer=game.getPlayer(source.getFirstTarget());
  if (player != null && targetPlayer != null) {
    int count=game.getBattlefield().countAll(new FilterCreaturePermanent(),targetPlayer.getId(),game);
    TargetCreaturePermanent creatures=new TargetCreaturePermanent(0,count,new FilterCreaturePermanent("creatures to put in the first pile"),true);
    List<Permanent> pile1=new ArrayList<>();
    creatures.setRequired(false);
    if (player.choose(Outcome.Neutral,creatures,source.getSourceId(),game)) {
      List<UUID> targets=creatures.getTargets();
      for (      UUID targetId : targets) {
        Permanent p=game.getPermanent(targetId);
        if (p != null) {
          pile1.add(p);
        }
      }
    }
    List<Permanent> pile2=new ArrayList<>();
    for (    Permanent p : game.getBattlefield().getAllActivePermanents(new FilterCreaturePermanent(),targetPlayer.getId(),game)) {
      if (!pile1.contains(p)) {
        pile2.add(p);
      }
    }
    boolean choice=targetPlayer.choosePile(Outcome.DestroyPermanent,"Choose a pile to destroy.",pile1,pile2,game);
    if (choice) {
      destroyPermanents(pile1,game,source);
    }
 else {
      destroyPermanents(pile2,game,source);
    }
    return true;
  }
  return false;
}
