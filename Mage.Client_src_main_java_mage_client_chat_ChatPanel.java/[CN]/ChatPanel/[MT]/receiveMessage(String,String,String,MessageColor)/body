{
  if (extendedViewMode.equals(VIEW_MODE.GAME)) {
    this.txtConversation.append(TIMESTAMP_COLOR,time + " ");
    Color textColor=MESSAGE_COLOR;
    if (color.equals(MessageColor.ORANGE)) {
      textColor=Color.ORANGE;
    }
    this.txtConversation.append(textColor,(username.isEmpty() ? "" : username + ":") + message + "\n");
  }
 else {
    this.txtConversation.append(TIMESTAMP_COLOR,time + " ");
    Color userColor;
    Color textColor=MESSAGE_COLOR;
    if (parentChatRef != null) {
      userColor=parentChatRef.session.getUserName().equals(username) ? MY_COLOR : OPPONENT_COLOR;
    }
 else {
      userColor=session.getUserName().equals(username) ? MY_COLOR : OPPONENT_COLOR;
      if (color.equals(MessageColor.ORANGE)) {
        userColor=Color.ORANGE;
        textColor=userColor;
      }
    }
    this.txtConversation.append(userColor,username + ": ");
    this.txtConversation.append(textColor,message + "\n");
  }
}
