{
  Player attacker=game.getPlayer(attackerId);
  this.retrieveMustBlockAttackerRequirements(attacker,game);
  Player controller;
  for (  UUID defenderId : getPlayerDefenders(game)) {
    Player defender=game.getPlayer(defenderId);
    if (defender != null) {
      boolean choose=true;
      if (blockController == null) {
        controller=defender;
      }
 else {
        controller=blockController;
      }
      while (choose) {
        controller.selectBlockers(game,defenderId);
        if (game.isPaused() || game.gameOver(null)) {
          return;
        }
        if (!this.checkBlockRestrictions(defender,game)) {
          if (controller.isHuman()) {
            continue;
          }
        }
        choose=!this.checkBlockRequirementsAfter(defender,controller,game);
        if (!choose) {
          choose=!this.checkBlockRestrictionsAfter(defender,controller,game);
        }
      }
      game.fireEvent(GameEvent.getEvent(GameEvent.EventType.DECLARED_BLOCKERS,defenderId,defenderId));
      if (!game.isSimulation())       this.logBlockerInfo(defender,game);
    }
  }
  TraceUtil.traceCombatIfNeeded(game,this);
}
