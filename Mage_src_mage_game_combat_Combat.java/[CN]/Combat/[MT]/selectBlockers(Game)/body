{
  if (!game.replaceEvent(GameEvent.getEvent(GameEvent.EventType.DECLARING_BLOCKERS,attackerId,attackerId))) {
    Player player=game.getPlayer(attackerId);
    checkBlockRequirementsBefore(player,game);
    for (    UUID defenderId : getPlayerDefenders(game)) {
      boolean choose=true;
      Player defender=game.getPlayer(defenderId);
      while (choose) {
        game.getPlayer(defenderId).selectBlockers(game,defenderId);
        if (game.isPaused() || game.isGameOver()) {
          return;
        }
        if (!checkBlockRestrictions(game.getPlayer(defenderId),game)) {
          if (player.isHuman()) {
            continue;
          }
        }
        choose=!checkBlockRequirementsAfter(defender,defender,game);
      }
      game.fireEvent(GameEvent.getEvent(GameEvent.EventType.DECLARED_BLOCKERS,defenderId,defenderId));
    }
    TraceUtil.traceCombatIfNeeded(game,this);
  }
}
