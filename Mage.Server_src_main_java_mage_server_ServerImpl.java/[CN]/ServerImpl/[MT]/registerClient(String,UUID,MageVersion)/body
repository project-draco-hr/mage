{
  UUID sessionId=null;
  try {
    if (version.compareTo(Main.getVersion()) != 0)     throw new MageException("Wrong client version " + version + ", expecting version "+ Main.getVersion());
    sessionId=SessionManager.getInstance().createSession(userName,clientId);
    logger.info("Session " + sessionId + " created for user "+ userName+ " at "+ getClientHost());
  }
 catch (  Exception ex) {
    handleException(ex);
  }
  return sessionId;
}
