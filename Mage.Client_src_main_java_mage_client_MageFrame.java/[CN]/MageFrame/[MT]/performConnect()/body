{
  String userName=prefs.get("userName","");
  String server=prefs.get("serverAddress","");
  int port=Integer.parseInt(prefs.get("serverPort",""));
  String proxyServer=prefs.get("proxyAddress","");
  int proxyPort=Integer.parseInt(prefs.get("proxyPort","0"));
  ProxyType proxyType=ProxyType.valueByText(prefs.get("proxyType","None"));
  String proxyUsername=prefs.get("proxyUsername","");
  String proxyPassword=prefs.get("proxyPassword","");
  int avatarId=PreferencesDialog.getSelectedAvatar();
  boolean showAbilityPickerForced=PreferencesDialog.getCachedValue(PreferencesDialog.KEY_SHOW_ABILITY_PICKER_FORCED,"true").equals("true");
  try {
    setCursor(new Cursor(Cursor.WAIT_CURSOR));
    Connection connection=new Connection();
    connection.setUsername(userName);
    connection.setHost(server);
    connection.setPort(port);
    connection.setProxyType(proxyType);
    connection.setProxyHost(proxyServer);
    connection.setProxyPort(proxyPort);
    connection.setProxyUsername(proxyUsername);
    connection.setProxyPassword(proxyPassword);
    connection.setAvatarId(avatarId);
    connection.setShowAbilityPickerForced(showAbilityPickerForced);
    connection.setUserSkipPrioritySteps(PreferencesDialog.getUserSkipPrioritySteps());
    logger.debug("connecting (auto): " + proxyType + " "+ proxyServer+ " "+ proxyPort+ " "+ proxyUsername);
    if (MageFrame.connect(connection)) {
      showGames(false);
      return true;
    }
 else {
      showMessage("Unable to connect to server");
    }
  }
  finally {
    setCursor(new Cursor(Cursor.DEFAULT_CURSOR));
  }
  return false;
}
