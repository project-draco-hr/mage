{
  long beforeCall=System.currentTimeMillis();
  List<CardInfo> cards=CardRepository.instance.getAllCards();
  logger.info("Card pool load time: " + ((System.currentTimeMillis() - beforeCall) / 1000 + " seconds"));
  String useDefault=PreferencesDialog.getCachedValue(PreferencesDialog.KEY_CARD_IMAGES_USE_DEFAULT,"true");
  String path=useDefault.equals("true") ? null : PreferencesDialog.getCachedValue(PreferencesDialog.KEY_CARD_IMAGES_PATH,null);
  beforeCall=System.currentTimeMillis();
  if (DownloadPictures.checkForNewCards(cards,path)) {
    logger.info("Card images checking time: " + ((System.currentTimeMillis() - beforeCall) / 1000 + " seconds"));
    if (JOptionPane.showConfirmDialog(null,"New cards are available.  Do you want to download the images?","New images available",JOptionPane.YES_NO_OPTION) == JOptionPane.YES_OPTION) {
      DownloadPictures.startDownload(null,cards,path);
    }
  }
}
