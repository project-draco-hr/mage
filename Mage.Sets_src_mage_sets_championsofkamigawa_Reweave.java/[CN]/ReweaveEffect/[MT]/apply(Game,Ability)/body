{
  Permanent permanent=game.getPermanent(source.getTargets().getFirstTarget());
  if (permanent != null) {
    if (permanent.sacrifice(this.getId(),game)) {
      Player player=game.getPlayer(permanent.getControllerId());
      if (player != null) {
        Library library=player.getLibrary();
        if (library.size() > 0) {
          Cards cards=new CardsImpl();
          Card card=null;
          boolean cardFound=false;
          if (library.size() > 0) {
            do {
              card=library.removeFromTop(game);
              cards.add(card);
              for (              CardType cardType : permanent.getCardType()) {
                if (card.getCardType().contains(cardType)) {
                  if (!card.getCardType().contains(CardType.INSTANT) && !card.getCardType().contains(CardType.SORCERY)) {
                    cardFound=true;
                    break;
                  }
                }
              }
            }
 while (!cardFound && library.size() > 0);
            card.putOntoBattlefield(game,Zone.PICK,source.getId(),player.getId());
          }
          if (cards.size() > 0) {
            player.revealCards("Reweave",cards,game);
            Set<Card> cardsToShuffle=cards.getCards(game);
            if (card != null) {
              cardsToShuffle.remove(card);
            }
            library.addAll(cardsToShuffle,game);
          }
        }
      }
    }
    return true;
  }
  return false;
}
