{
  UUID currentPlayerId=node.getGame().getPlayerList().get();
  SimulationNode bestChild=null;
  for (  SimulationNode child : node.getChildren()) {
    if (alpha >= beta) {
      logger.fine("alpha beta pruning");
      break;
    }
    if (SimulationNode.nodeCount > maxNodes) {
      logger.fine("simulating -- reached end-state");
      break;
    }
    int val=addActions(child,filter,depth - 1,alpha,beta);
    if (!currentPlayerId.equals(playerId)) {
      if (val < beta) {
        beta=val;
        bestChild=child;
        if (node.getCombat() == null)         node.setCombat(child.getCombat());
      }
    }
 else {
      if (val > alpha) {
        alpha=val;
        bestChild=child;
        if (node.getCombat() == null)         node.setCombat(child.getCombat());
      }
    }
  }
  node.children.clear();
  if (bestChild != null)   node.children.add(bestChild);
  if (!currentPlayerId.equals(playerId)) {
    logger.fine("returning minimax beta: " + beta);
    return beta;
  }
 else {
    logger.fine("returning minimax alpha: " + alpha);
    return alpha;
  }
}
