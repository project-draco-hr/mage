{
  Player controller=game.getPlayer(source.getControllerId());
  if (controller != null) {
    Set<Permanent> choosenPermanent=new HashSet<>();
    for (    UUID playerId : game.getState().getPlayersInRange(controller.getId(),game)) {
      Player player=game.getPlayer(playerId);
      if (player != null) {
        FilterArtifactPermanent filterArtifactPermanent=new FilterArtifactPermanent("an artifact of " + player.getName());
        filterArtifactPermanent.add(new ControllerIdPredicate(playerId));
        Target target1=new TargetArtifactPermanent(1,1,filterArtifactPermanent,true);
        FilterCreaturePermanent filterCreaturePermanent=new FilterCreaturePermanent("a creature of " + player.getName());
        filterCreaturePermanent.add(new ControllerIdPredicate(playerId));
        Target target2=new TargetPermanent(1,1,filterCreaturePermanent,true);
        FilterEnchantmentPermanent filterEnchantmentPermanent=new FilterEnchantmentPermanent("an enchantment of " + player.getName());
        filterEnchantmentPermanent.add(new ControllerIdPredicate(playerId));
        Target target3=new TargetPermanent(1,1,filterEnchantmentPermanent,true);
        FilterPlaneswalkerPermanent filterPlaneswalkerPermanent=new FilterPlaneswalkerPermanent("a planeswalker of " + player.getName());
        filterPlaneswalkerPermanent.add(new ControllerIdPredicate(playerId));
        Target target4=new TargetPermanent(1,1,filterPlaneswalkerPermanent,true);
        if (target1.canChoose(controller.getId(),game)) {
          controller.chooseTarget(Outcome.Benefit,target1,source,game);
          Permanent artifact=game.getPermanent(target1.getFirstTarget());
          if (artifact != null) {
            choosenPermanent.add(artifact);
          }
          target1.clearChosen();
        }
        if (target2.canChoose(player.getId(),game)) {
          controller.chooseTarget(Outcome.Benefit,target2,source,game);
          Permanent creature=game.getPermanent(target2.getFirstTarget());
          if (creature != null) {
            choosenPermanent.add(creature);
          }
          target2.clearChosen();
        }
        if (target3.canChoose(player.getId(),game)) {
          controller.chooseTarget(Outcome.Benefit,target3,source,game);
          Permanent enchantment=game.getPermanent(target3.getFirstTarget());
          if (enchantment != null) {
            choosenPermanent.add(enchantment);
          }
          target3.clearChosen();
        }
        if (target4.canChoose(player.getId(),game)) {
          controller.chooseTarget(Outcome.Benefit,target4,source,game);
          Permanent planeswalker=game.getPermanent(target4.getFirstTarget());
          if (planeswalker != null) {
            choosenPermanent.add(planeswalker);
          }
          target4.clearChosen();
        }
      }
    }
    for (    UUID playerId : game.getState().getPlayersInRange(controller.getId(),game)) {
      Player player=game.getPlayer(playerId);
      if (player != null) {
        for (        Permanent permanent : game.getBattlefield().getAllActivePermanents(new FilterNonlandPermanent(),game)) {
          if (!choosenPermanent.contains(permanent)) {
            permanent.sacrifice(playerId,game);
          }
        }
      }
    }
    return true;
  }
  return false;
}
