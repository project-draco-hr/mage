{
  tableModel=new TableTableModel();
  matchesModel=new MatchesTableModel();
  gameChooser=new GameChooser();
  initComponents();
  tableModel.setSession(session);
  chkShowCompleted.setVisible(true);
  tableTables.createDefaultColumnsFromModel();
  chatPanel.useExtendedView(ChatPanel.VIEW_MODE.NONE);
  chatPanel.setBorder(null);
  JComponent[] components=new JComponent[]{chatPanel,jSplitPane1,jScrollPane1,jScrollPane2,jPanel1,jPanel3};
  for (  JComponent component : components) {
    component.setOpaque(false);
  }
  jScrollPane1.getViewport().setBackground(new Color(255,255,255,50));
  jScrollPane2.getViewport().setBackground(new Color(255,255,255,50));
  Action joinTable;
  joinTable=new AbstractAction(){
    @Override public void actionPerformed(    ActionEvent e){
      int modelRow=Integer.valueOf(e.getActionCommand());
      UUID tableId=(UUID)tableModel.getValueAt(modelRow,TableTableModel.ACTION_COLUMN + 3);
      UUID gameId=(UUID)tableModel.getValueAt(modelRow,TableTableModel.ACTION_COLUMN + 2);
      String action=(String)tableModel.getValueAt(modelRow,TableTableModel.ACTION_COLUMN);
      boolean isTournament=(Boolean)tableModel.getValueAt(modelRow,TableTableModel.ACTION_COLUMN + 1);
      String owner=(String)tableModel.getValueAt(modelRow,1);
      if (action.equals("Join")) {
        if (owner.equals(session.getUserName())) {
          try {
            JDesktopPane desktopPane=(JDesktopPane)MageFrame.getUI().getComponent(MageComponents.DESKTOP_PANE);
            JInternalFrame[] windows=desktopPane.getAllFramesInLayer(javax.swing.JLayeredPane.DEFAULT_LAYER);
            for (            JInternalFrame frame : windows) {
              if (frame.getTitle().equals("Waiting for players")) {
                frame.toFront();
                frame.setVisible(true);
                try {
                  frame.setSelected(true);
                }
 catch (                PropertyVetoException ve) {
                  ve.printStackTrace();
                  logger.error(ve);
                }
              }
            }
          }
 catch (          Exception ex) {
            logger.error(ex);
          }
          return;
        }
        if (isTournament) {
          logger.info("Joining tournament " + tableId);
          session.joinTournamentTable(roomId,tableId,session.getUserName(),"Human",1);
        }
 else {
          logger.info("Joining table " + tableId);
          joinTableDialog.showDialog(roomId,tableId);
        }
      }
 else       if (action.equals("Remove")) {
        if (JOptionPane.showConfirmDialog(null,"Are you sure you want to remove table?","Removing table",JOptionPane.YES_NO_OPTION) == JOptionPane.YES_OPTION) {
          session.removeTable(roomId,tableId);
        }
      }
 else       if (action.equals("Show")) {
        if (isTournament) {
          logger.info("Showing tournament table " + tableId);
          session.watchTable(roomId,tableId);
        }
      }
 else       if (action.equals("Watch")) {
        if (!isTournament) {
          logger.info("Watching table " + tableId);
          session.watchTable(roomId,tableId);
        }
      }
 else       if (action.equals("Replay")) {
        logger.info("Replaying game " + gameId);
      }
    }
  }
;
  Action replayMatch=new AbstractAction(){
    @Override public void actionPerformed(    ActionEvent e){
      int modelRow=Integer.valueOf(e.getActionCommand());
      if (matchesModel.getValueAt(modelRow,MatchesTableModel.ACTION_COLUMN) instanceof List) {
        List<UUID> games=(List<UUID>)matchesModel.getValueAt(modelRow,MatchesTableModel.ACTION_COLUMN);
        if (games.size() == 1) {
          session.replayGame(games.get(0));
        }
 else {
          gameChooser.show(games,MageFrame.getDesktop().getMousePosition());
        }
      }
    }
  }
;
  new ButtonColumn(tableTables,joinTable,TableTableModel.ACTION_COLUMN);
  new ButtonColumn(tableCompleted,replayMatch,MatchesTableModel.ACTION_COLUMN);
}
