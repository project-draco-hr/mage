{
  if (userId != null) {
    ChatManager.getInstance().removeUser(userId,User.DisconnectReason.Disconnected);
    if (users.containsKey(userId)) {
      logger.info("user disconnected " + userId);
      users.get(userId).setSessionId("");
      ChatManager.getInstance().broadcast(userId,"has lost connection",MessageColor.BLACK);
    }
  }
}
