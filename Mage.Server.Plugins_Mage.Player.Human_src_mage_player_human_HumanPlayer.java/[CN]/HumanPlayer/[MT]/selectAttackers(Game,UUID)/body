{
  updateGameStatePriority("selectAttackers",game);
  FilterCreatureForCombat filter=filterCreatureForCombat.copy();
  filter.add(new ControllerIdPredicate(attackingPlayerId));
  while (!abort) {
    if (passedAllTurns || (!getUserData().getUserSkipPrioritySteps().isStopOnDeclareAttackersDuringSkipAction() && (passedTurn || passedUntilEndOfTurn || passedUntilNextMain))) {
      return;
    }
    Map<String,Serializable> options=new HashMap<>();
    List<UUID> possibleAttackers=new ArrayList<>();
    for (    Permanent possibleAttacker : game.getBattlefield().getActivePermanents(filter,attackingPlayerId,game)) {
      if (possibleAttacker.canAttack(game)) {
        possibleAttackers.add(possibleAttacker.getId());
      }
    }
    options.put(Constants.Option.POSSIBLE_ATTACKERS,(Serializable)possibleAttackers);
    game.fireSelectEvent(playerId,"Select attackers",options);
    waitForResponse(game);
    if (response.getBoolean() != null) {
      if (!game.getCombat().getCreaturesForcedToAttack().isEmpty()) {
        if (!game.getCombat().getAttackers().containsAll(game.getCombat().getCreaturesForcedToAttack().keySet())) {
          int forcedAttackers=0;
          StringBuilder sb=new StringBuilder();
          for (          UUID creatureId : game.getCombat().getCreaturesForcedToAttack().keySet()) {
            boolean validForcedAttacker=false;
            if (game.getCombat().getAttackers().contains(creatureId)) {
              Set<UUID> possibleDefender=game.getCombat().getCreaturesForcedToAttack().get(creatureId);
              if (possibleDefender.isEmpty() || possibleDefender.contains(game.getCombat().getDefenderId(creatureId))) {
                validForcedAttacker=true;
              }
            }
            if (validForcedAttacker) {
              forcedAttackers++;
            }
 else {
              Permanent creature=game.getPermanent(creatureId);
              if (creature != null) {
                sb.append(creature.getName()).append(" ");
              }
            }
          }
          if (game.getCombat().getMaxAttackers() > forcedAttackers) {
            game.informPlayer(this,sb.insert(0," more attacker(s) that are forced to attack.\nCreatures forced to attack: ").insert(0,Math.min(game.getCombat().getMaxAttackers() - forcedAttackers,game.getCombat().getCreaturesForcedToAttack().size() - forcedAttackers)).insert(0,"You have to attack with ").toString());
            continue;
          }
        }
      }
      return;
    }
 else     if (response.getInteger() != null) {
      return;
    }
 else     if (response.getUUID() != null) {
      Permanent attacker=game.getPermanent(response.getUUID());
      if (attacker != null) {
        if (filterCreatureForCombat.match(attacker,null,playerId,game)) {
          selectDefender(game.getCombat().getDefenders(),attacker.getId(),game);
        }
 else         if (filterAttack.match(attacker,null,playerId,game) && game.getStack().isEmpty()) {
          removeAttackerIfPossible(game,attacker);
        }
      }
    }
  }
}
