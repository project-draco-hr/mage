{
  updateGameStatePriority("choose(5)",game);
  while (!abort) {
    Set<UUID> cards=target.possibleTargets(null,playerId,game);
    game.fireSelectTargetEvent(playerId,target.getMessage(),cards,target.isRequired(),options);
    waitForResponse();
    if (response.getUUID() != null) {
      if (target instanceof TargetPermanent) {
        if (((TargetPermanent)target).canTarget(playerId,response.getUUID(),sourceId,game,false)) {
          target.add(response.getUUID(),game);
          if (target.doneChosing()) {
            return true;
          }
        }
      }
 else       if (target.canTarget(response.getUUID(),game)) {
        target.add(response.getUUID(),game);
        if (target.doneChosing()) {
          return true;
        }
      }
    }
 else {
      if (target.getTargets().size() >= target.getNumberOfTargets()) {
        return true;
      }
      if (!target.isRequired()) {
        return false;
      }
      if (cards == null || cards.isEmpty()) {
        return false;
      }
    }
  }
  return false;
}
