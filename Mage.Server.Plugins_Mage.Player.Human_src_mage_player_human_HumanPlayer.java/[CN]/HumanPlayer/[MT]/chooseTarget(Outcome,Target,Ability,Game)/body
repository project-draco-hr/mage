{
  game.getState().setPriorityPlayerId(getId());
  while (!abort) {
    game.fireSelectTargetEvent(playerId,target.getMessage(),target.possibleTargets(source == null ? null : source.getId(),playerId,game),target.isRequired(),target.getNumberOfTargets() != target.getMaxNumberOfTargets() ? staticOptions : null);
    waitForResponse();
    if (response.getUUID() != null) {
      if (target instanceof TargetPermanent) {
        if (((TargetPermanent)target).canTarget(playerId,response.getUUID(),source,game)) {
          target.addTarget(response.getUUID(),source,game);
          return true;
        }
      }
 else       if (target.canTarget(response.getUUID(),source,game)) {
        target.addTarget(response.getUUID(),source,game);
        return true;
      }
    }
 else     if (!target.isRequired()) {
      return false;
    }
  }
  return false;
}
