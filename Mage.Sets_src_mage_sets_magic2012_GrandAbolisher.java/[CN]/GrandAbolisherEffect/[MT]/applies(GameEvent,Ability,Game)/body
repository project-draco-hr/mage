{
  if (game.getActivePlayerId().equals(source.getControllerId()) && game.getOpponents(source.getControllerId()).contains(event.getPlayerId())) {
switch (event.getType()) {
case CAST_SPELL:
      return true;
case ACTIVATE_ABILITY:
    Permanent permanent=game.getPermanent(event.getSourceId());
  if (permanent != null) {
    return permanent.getCardType().contains(CardType.ARTIFACT) || permanent.getCardType().contains(CardType.CREATURE) || permanent.getCardType().contains(CardType.ENCHANTMENT);
  }
}
}
return false;
}
